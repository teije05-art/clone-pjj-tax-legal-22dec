# Workflow

This document describes the standard development workflow for new features, bug fixes, and other tasks within the PJJ Tax & Legal AI System, especially when guided by the Conductor AI agent.

## General Principles

- **Spec-driven Development**: All significant changes start with a clear specification (`spec.md`).
- **Iterative Planning**: Plans (`plan.md`) are broken down into phases and tasks, allowing for iterative execution and review.
- **Human-in-the-Loop**: Key decision points and verification steps involve human oversight.
- **Test-Driven Development (TDD) where applicable**: For code-related tasks, tests are often written before implementation.

## Standard Development Phases and Tasks

The following outlines a typical `plan.md` structure generated by the Conductor agent.

### Phase 1: Planning & Specification (Managed by Conductor)

- **Task: Define Track Description**: User provides a high-level overview of the feature/bug/chore.
- **Task: Generate Specification (`spec.md`)**: Conductor asks guiding questions, user provides answers, Conductor drafts and user confirms `spec.md`.
- **Task: Generate Initial Plan (`plan.md`)**: Conductor drafts initial `plan.md` based on `spec.md` and this `workflow.md`, user confirms.
- [ ] Task: Conductor - User Manual Verification 'Planning & Specification' (Protocol in workflow.md)

### Phase 2: Implementation

This phase involves the actual coding and testing. Tasks within this phase often follow a TDD approach.

- **Task: Environment Setup**: Ensure the local development environment is configured correctly.
- **Task: Code Implementation**: Write or modify code to fulfill the requirements.
    - [ ] Sub-task: Write Unit Tests (if applicable)
    - [ ] Sub-task: Implement Feature/Fix
    - [ ] Sub-task: Run Local Tests
- **Task: Integration Testing**: Test how the new code interacts with existing parts of the system.
- [ ] Task: Conductor - User Manual Verification 'Implementation' (Protocol in workflow.md)

### Phase 3: Review & Validation

This phase focuses on ensuring quality and adherence to the specification.

- **Task: Code Review**: Peer review of the implemented code.
- **Task: Acceptance Testing**: Verify the solution meets all acceptance criteria defined in `spec.md`.
- **Task: Documentation Update**: Update any relevant documentation (e.g., `README.md`, technical docs).
- [ ] Task: Conductor - User Manual Verification 'Review & Validation' (Protocol in workflow.md)

### Phase 4: Deployment (if applicable)

For deployable features or fixes.

- **Task: Build Artifacts**: Generate deployable packages or images.
- **Task: Deployment to Staging**: Deploy the changes to a staging environment.
- **Task: Production Rollout**: Deploy the changes to the production environment.
- [ ] Task: Conductor - User Manual Verification 'Deployment' (Protocol in workflow.md)

## Phase Completion Verification and Checkpointing Protocol

At the end of each major Phase, a "Conductor - User Manual Verification" task is automatically added to the `plan.md`. The user is expected to manually review all tasks and sub-tasks within that phase and mark them as complete. This acts as a checkpoint before proceeding to the next phase. The user should ensure:

1. All defined tasks and sub-tasks for the phase are completed.
2. The work meets the quality standards and objectives for that phase.
3. Any necessary artifacts (tests, documentation) are in place.
